{% extends "base.html" %}
{% block content %}

<div class="admin-container">

    <!-- HEADER -->
    <div class="admin-header">
        <h2>Panel de Administraci√≥n</h2>
        <a href="{{ url_for('logout') }}" class="logout-link">Cerrar sesi√≥n</a>
    </div>

    <!-- FORMULARIO -->
    <div class="admin-card">
        <h3>Agregar inmueble</h3>

        <form method="POST"
              action="{{ url_for('agregar_inmueble') }}"
              class="admin-form"
              id="formInmueble">

            <div class="form-group">
                <label>T√≠tulo</label>
                <input type="text" name="titulo" required>
            </div>

            <div class="form-group">
                <label>Descripci√≥n corta</label>
                <textarea name="descripcion" rows="3"></textarea>
            </div>

            <div class="form-group full-width">
                <label>Informaci√≥n detallada</label>
                <textarea name="descripcion_larga" rows="5"></textarea>
            </div>

            <div class="form-group">
                <label>Tipo de inmueble</label>
                <select name="tipo" id="tipo" required>
                    <option value="">Seleccionar</option>
                    <option value="Casa">Casa</option>
                    <option value="Apartamento">Apartamento</option>
                    <option value="Oficina">Oficina</option>
                    <option value="Local">Local</option>
                    <option value="Lote">Lote</option>
                </select>
            </div>

            <div class="form-group">
                <label>Municipio</label>
                <input type="text" name="municipio" required>
            </div>

            <!-- CAMPOS DIN√ÅMICOS -->
            <div class="form-group campo-habitaciones">
                <label>Habitaciones</label>
                <input type="number" name="habitaciones">
            </div>

            <div class="form-group campo-banos">
                <label>Ba√±os</label>
                <input type="number" name="banos">
            </div>

            <div class="form-group campo-parqueadero">
                <label>Parqueadero</label>
                <select name="parqueadero">
                    <option value="0">No</option>
                    <option value="1">S√≠</option>
                </select>
            </div>

            <div class="form-group">
                <label>Precio</label>
                <input type="number" name="precio" required>
            </div>

            <div class="form-group full-width">
                <label>Imagen URL</label>
                <input type="text" name="imagen_url">
            </div>

            <div class="form-group full-width">
                <button type="submit">Agregar inmueble</button>
            </div>

        </form>
    </div>

    <hr>

    <!-- LISTA -->
    <div class="admin-card">
        <h3>Lista de inmuebles</h3>

        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>T√≠tulo</th>
                    <th>Tipo</th>
                    <th>Municipio</th>
                    <th>Imagen</th>
                    <th>Precio</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
            {% for i in inmuebles %}
                <tr>
                    <td>{{ i.id }}</td>
                    <td>{{ i.titulo }}</td>
                    <td>{{ i.tipo }}</td>
                    <td>{{ i.municipio }}</td>
                    <td>
                        {% if i.imagen_url %}
                            <img src="{{ i.imagen_url }}" alt="img">
                        {% endif %}
                    </td>
                    <td>${{ "{:,.0f}".format(i.precio) }}</td>
                    <td>
    <div class="acciones">
        <a href="{{ url_for('editar_inmueble', id=i.id) }}" class="btn-edit">
            ‚úèÔ∏è Editar
        </a>

        <form action="{{ url_for('eliminar_inmueble', id=i.id) }}"
              method="POST"
              onsubmit="return confirm('¬øEliminar inmueble?')">
            <button type="submit" class="btn-delete">
                üóëÔ∏è Eliminar
            </button>
        </form>
    </div>
</td>

                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

</div>

<!-- ===============================
     JS CAMPOS DIN√ÅMICOS
================================ -->
<script>
const tipo = document.getElementById("tipo");
const habitaciones = document.querySelector(".campo-habitaciones");
const banos = document.querySelector(".campo-banos");
const parqueadero = document.querySelector(".campo-parqueadero");

function actualizarCampos() {
    habitaciones.style.display = "none";
    banos.style.display = "none";
    parqueadero.style.display = "none";

    if (tipo.value === "Casa" || tipo.value === "Apartamento") {
        habitaciones.style.display = "flex";
        banos.style.display = "flex";
        parqueadero.style.display = "flex";
    }

    if (tipo.value === "Oficina") {
        banos.style.display = "flex";
        parqueadero.style.display = "flex";
    }
}

// Ejecutar al cargar
actualizarCampos();
tipo.addEventListener("change", actualizarCampos);
</script>

{% endblock %}


