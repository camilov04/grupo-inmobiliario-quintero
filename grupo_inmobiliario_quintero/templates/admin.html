{% extends "base.html" %}
{% block content %}

<div class="admin-container">

<h2>Panel de Administraci√≥n</h2>

<form method="POST" action="{{ url_for('agregar_inmueble') }}" class="admin-form" id="formInmueble">

<div class="form-group">
<label>T√≠tulo</label>
<input type="text" name="titulo" required>
</div>

<div class="form-group">
<label>Tipo de negocio</label>
<select name="tipo_negocio" required>
<option value="Venta">Venta</option>
<option value="Arriendo">Arriendo</option>
</select>
</div>

<div class="form-group full-width">
<label>Descripci√≥n</label>
<textarea name="descripcion" rows="5" required></textarea>
</div>

<div class="form-group">
<label>Tipo de inmueble</label>
<select name="tipo" id="tipo">
<option>Casa</option>
<option>Apartamento</option>
<option>Oficina</option>
<option>Local</option>
<option>Lote</option>
</select>
</div>

<div class="form-group">
<label>Municipio</label>
<input type="text" name="municipio" required>
</div>

<div class="form-group campo-habitaciones">
<label>Habitaciones</label>
<input type="number" name="habitaciones">
</div>

<div class="form-group campo-banos">
<label>Ba√±os</label>
<input type="number" name="banos">
</div>

<div class="form-group campo-parqueadero">
<label>Parqueadero</label>
<select name="parqueadero">
<option value="0">No</option>
<option value="1">S√≠</option>
</select>
</div>

<div class="form-group">
<label>Precio</label>
<input type="number" name="precio" required>
</div>

<div class="form-group full-width">
<label>Imagen URL</label>
<input type="text" name="imagen_url">
</div>

<div class="form-group full-width">
<button type="submit">Guardar inmueble</button>
</div>

</form>

<hr>

<h3>Inmuebles registrados</h3>

<table>
<tr>
<th>Imagen</th>
<th>T√≠tulo</th>
<th>Negocio</th>
<th>Tipo</th>
<th>Precio</th>
<th>Acciones</th>
</tr>

{% for i in inmuebles %}
<tr>
<td>
    {% if i.imagen_url %}
        <img src="{{ i.imagen_url }}" alt="img" width="60">
    {% else %}
        ‚Äî
    {% endif %}
</td>
<td>{{ i.titulo }}</td>
<td>{{ i.tipo_negocio }}</td>
<td>{{ i.tipo }}</td>
<td>${{ "{:,.0f}".format(i.precio) }}</td>
<td>
    <div class="acciones">
        <a href="{{ url_for('editar_inmueble', id=i.id) }}" class="btn-edit">‚úèÔ∏è</a>

        <form method="POST"
              action="{{ url_for('eliminar_inmueble', id=i.id) }}"
              onsubmit="return confirmarEliminacion();">
            <button type="submit" class="btn-delete">üóëÔ∏è</button>
        </form>
    </div>
</td>
</tr>

{% endfor %}
</table>

</div>

<script>
const tipo = document.getElementById("tipo");
const hab = document.querySelector(".campo-habitaciones");
const ban = document.querySelector(".campo-banos");
const parq = document.querySelector(".campo-parqueadero");

function actualizarCampos() {
    hab.style.display = "none";
    ban.style.display = "none";
    parq.style.display = "none";

    if (tipo.value === "Casa" || tipo.value === "Apartamento") {
        hab.style.display = "flex";
        ban.style.display = "flex";
        parq.style.display = "flex";
    }

    if (tipo.value === "Oficina") {
        ban.style.display = "flex";
        parq.style.display = "flex";
    }
}

tipo.addEventListener("change", actualizarCampos);
actualizarCampos();
</script>
<script>
function confirmarEliminacion() {
    return confirm("‚ö†Ô∏è ¬øEst√°s seguro de eliminar este inmueble?\nEsta acci√≥n no se puede deshacer.");
}
</script>
{% endblock %}
