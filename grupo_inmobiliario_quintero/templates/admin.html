{% extends "base.html" %}

{% block content %}
<h2>Panel de Administraci√≥n</h2>
<a href="{{ url_for('logout') }}" class="btn-delete" style="float:right;">Cerrar sesi√≥n</a>

<!-- FORMULARIO AGREGAR INMUEBLE -->
<div class="admin-container">
    <h2>Agregar inmueble</h2>

  <div class="admin-card">
      <form method="POST" action="{{ url_for('agregar_inmueble') }}" class="admin-form">

        <div class="form-group">
            <label>T√≠tulo:</label>
            <input type="text" name="titulo" required>
        </div>

        <div class="form-group">
            <label>Descripci√≥n corta:</label>
            <textarea name="descripcion" required></textarea>
        </div>

        <div class="form-group full-width">
            <label>Informaci√≥n detallada:</label>
            <textarea 
                name="descripcion_larga" 
                rows="6"
                placeholder="Informaci√≥n ampliada del inmueble (servicios, zonas comunes, detalles, etc.)">
            </textarea>
        </div>

        <div class="form-group">
            <label>Tipo de inmueble:</label>
            <select name="tipo" required>
                <option value="">Seleccionar</option>
                <option value="Apartamento">Apartamento</option>
                <option value="Casa">Casa</option>
                <option value="Local">Local</option>
                <option value="Lote">Lote</option>
                <option value="Oficina">Oficina</option>
            </select>
        </div>

        <div class="form-group">
            <label>Municipio:</label>
            <input type="text" name="municipio" required>
        </div>

        <div class="form-group">
            <label>Habitaciones:</label>
            <input type="number" name="habitaciones" required>
        </div>

        <div class="form-group" id="group-banos">
            <label>Ba√±os:</label>
            <input type="number" name="banos" min="0">
        </div>

        <div class="form-group">
            <label>Precio:</label>
            <input type="number" name="precio" required>
        </div>

        <div class="form-group">
            <label>Imagen URL:</label>
            <input type="text" name="imagen_url">
        </div>

        <div class="form-group full-width">
            <button type="submit">Agregar</button>
        </div>

    </form>
  </div>
</div>


<hr>

<!-- TABLA DE INMUEBLES -->
<h3>Lista de inmuebles</h3>
<table>
    <tr>
        <th>ID</th>
        <th>T√≠tulo</th>
        <th>Descripci√≥n</th>
        <th>Tipo</th>
        <th>Municipio</th>
        <th>Habitaciones</th>
        <th>Precio</th>
        <th>Imagen</th>
        <th>Acciones</th>
    </tr>

    {% for i in inmuebles %}
    <tr>
        <td>{{ i.id }}</td>
        <td>{{ i.titulo }}</td>
        <td>{{ i.descripcion }}</td>
        <td>{{ i.tipo }}</td>
        <td>{{ i.municipio }}</td>
        <td>{{ i.habitaciones }}</td>
        <td>${{ i.precio }}</td>
        <td>
            {% if i.imagen_url %}
                <img src="{{ i.imagen_url }}" width="100">
            {% endif %}
        </td>
        <td>
            <a href="{{ url_for('editar_inmueble', id=i.id) }}">‚úèÔ∏è Editar</a>

            <form action="{{ url_for('eliminar_inmueble', id=i.id) }}"
                  method="POST" style="display:inline;">
                <button type="submit">üóëÔ∏è Eliminar</button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>
<script>
const tipoSelect = document.querySelector('select[name="tipo"]');

const groupHabitaciones = document.querySelector('input[name="habitaciones"]').closest('.form-group');
const groupBanos = document.querySelector('input[name="banos"]').closest('.form-group');

function actualizarCampos() {
    const tipo = tipoSelect.value;

    // Reset
    groupHabitaciones.style.display = 'none';
    groupBanos.style.display = 'none';

    if (tipo === 'Casa' || tipo === 'Apartamento') {
        groupHabitaciones.style.display = 'flex';
        groupBanos.style.display = 'flex';
    }

    if (tipo === 'Oficina' || tipo === 'Local') {
        groupBanos.style.display = 'flex';
    }

    // Lote ‚Üí no muestra nada
}

tipoSelect.addEventListener('change', actualizarCampos);
actualizarCampos();
</script>

{% endblock %}
